---
author: jecyu
layout: post
title: "ä½¿ç”¨HTML5 localStorageå®ç°æœ¬åœ°å­˜å‚¨"
date: 2017-12-10
comments: true
categories:
---

åœ¨ç”¨æˆ·è®¡ç®—æœºä¸Šæœ¬åœ°å­˜å‚¨ä¿¡æ¯å¯¹äºç½‘ç«™å¼€å‘äººä¸æ¥è¯´æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç­–ç•¥ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†å¯ä»¥å­¦åˆ°äº†localStorageåœ¨è®¡ç®—æœºä¸Šå­˜å‚¨ä¿¡æ¯æ˜¯å¤šä¹ˆåœ°å®¹æ˜“ï¼Œå¹¶è§£é‡Šäº†å®ƒçš„åº”ç”¨ã€‚

## ä¸€ã€ä½¿ç”¨LocalStorage çš„ç›®çš„ï¼šä¸ºäº†æ·»åŠ çŠ¶æ€åˆ°Webåº”ç”¨ä¸­

HTTPåè®®ä½œä¸ºç½‘ç»œçš„ä¸»è¦ä¼ è¾“å±‚çš„æœ€å¤§é—®é¢˜æ˜¯æ— çŠ¶æ€çš„ï¼Œå³æœåŠ¡å™¨ä¸çŸ¥é“ç”¨æˆ·ä¸Šä¸€æ¬¡åšäº†ä»€ä¹ˆï¼Œè¿™æ ·æ„å‘³ç€ä½ ä½¿ç”¨æµè§ˆå™¨è®¿é—®ä¸€ä¸ªç½‘ç«™å¦‚è¾›è‹¦çš„å¡«äº†ä¸€ä¸ªè¡¨å•ï¼Œç”±äºä¸å¯æè¿°çš„åŸå› ï¼Œç½‘ç«™è¢«å…³é—­ã€‚ç„¶åä½ å†æ¬¡é‡æ–°æ‰“å¼€å®ƒæ—¶ï¼Œç©ºç©ºå¦‚ä¹Ÿï¼Œwhatï¼ï¼ï¼Ÿï¼Ÿï¼Ÿï¼Ÿè¿™æ˜¯å› ä¸ºä½ å…³é—­æ¡Œé¢ä¸Šçš„åº”ç”¨ç¨‹åºæ—¶å¹¶é‡æ–°æ‰“å¼€å®ƒï¼Œå®ƒä¼šæ¢å¤åˆ°æœ€æ–°çš„çŠ¶æ€ï¼Œä¸ä¼šè®°å½•ä½ æ‰€å¡«çš„ä¸œè¥¿ã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½œä¸ºå¼€å‘äººå‘˜ï¼Œæœ‰æ—¶å€™ä½ éœ€è¦å°†ä½ çš„æ¥å£çŠ¶æ€å­˜å‚¨åˆ°æŸä¸ªåœ°æ–¹ã€‚é€šå¸¸ï¼Œè¿™æ˜¯åœ¨æœåŠ¡ç«¯å®Œæˆçš„ï¼Œé€šè¿‡æ£€æµ‹ç”¨æˆ·åæ¥çŸ¥é“è¦æ¢å¤åˆ°å“ªä¸ªçŠ¶æ€ã€‚ä½†æ˜¯å¦‚æœä½ ä¸æƒ³å¼ºè¿«åˆ«äººè¿›è¡Œæ³¨å†Œå‘¢ï¼Ÿï¼ˆæ—ç™½ï¼šæœ‰æ—¶å€™æˆ‘ä»¬åªæ˜¯è¹­è¹­ä¸è¿›å»ğŸ˜„ï¼‰

è¿™æ—¶å€™å°±éœ€è¦local storageå‡ºåœºäº†ï¼Œä½ å¯ä»¥åœ¨ç”¨æˆ·çš„è®¡ç®—æœºä¸Šä¿å­˜ä¸€ä¸ªé’¥åŒ™keyï¼Œåœ¨ç”¨æˆ·é‡æ–°è®¿é—®æ—¶è·å–å®ƒæ¥è®°å½•è¹­è¿‡çš„ç—•è¿¹ã€‚

## äºŒã€ä½¿ç”¨cookieå¯¹æˆ‘ä»¬æ¥è¯´è¶³å¤Ÿå¥½äº†å—ï¼Ÿ 

åŒåä¸€é›¶ç‚¹é›¶åˆ†ï¼ŒèŠ±æ£®èµ¶å¿«æ‰“å¼€æŸå®ï¼Œä¸ç”¨è¾“å…¥å¸å·å¯†ç å°±ç™»å½•äº†ï¼ˆå…¶å®æ˜¯Cookieåœ¨èµ·ä½œç”¨ï¼Œè®°å½•äº†ä¸Šæ¬¡çš„ç™»å½•ä¿¡æ¯ï¼‰ã€‚çœŸå¥½ï¼èŠ±æ£®é€Ÿé€Ÿæµè§ˆäº†å‡ ä¸ªç½‘é¡µï¼Œä¹°äº†ä¸€å¥—cosplayå¥³è£…ã€‚åœ¨ç»“è´¦æ—¶ç”±äºhttpçš„æ— çŠ¶æ€æ€§ï¼ŒæœåŠ¡å™¨å¹¶ä¸çŸ¥é“ç”¨æˆ·ï¼ˆèŠ±æ£®ï¼‰åˆ°åº•ä¹°äº†ä»€ä¹ˆã€‚ç»å…¸åšæ³•æ˜¯ä½¿ç”¨cookieï¼ŒæœåŠ¡å™¨é€šè¿‡è®¾ç½®æˆ–è¯»å–Cookiesä¸­çš„ä¿¡æ¯ï¼Œæ¥ç»´æŠ¤ç”¨æˆ·ï¼ˆèŠ±æ£®ï¼‰è·ŸæœåŠ¡å™¨çš„ä¼šè¯çŠ¶æ€ã€‚åœ¨èŠ±æ£®é€‰è´­ä¸€é¡¹å•†å“æ—¶ï¼ŒæœåŠ¡å™¨åœ¨å‘èŠ±æ£®å‘é€ç½‘é¡µçš„åŒæ—¶è¿˜å‘é€ä¸€æ®µCookieï¼Œè®°å½•ç€cosplayå¥³è£…çš„ä¿¡æ¯ã€‚å½“èŠ±æ£®å»è®¿é—®å¦ä¸€ä¸ªé¡µé¢æ—¶ï¼Œæµè§ˆå™¨ä¼šæŠŠCookieå‘é€ç»™æœåŠ¡å™¨ï¼Œäºæ˜¯æœåŠ¡å™¨å°±çŸ¥é“èŠ±æ£®ä¹‹å‰ä¹°äº†ä»€ä¹ˆå•¦ã€‚èŠ±æ£®ç»§ç»­è´­ä¹°é‹å­ï¼Œè¿™æ—¶å€™æœåŠ¡å™¨åªéœ€è¦åœ¨é‚£æ®µCookieä¸­è¿½åŠ æ–°çš„å•†å“ä¿¡æ¯å°±è¡Œäº†ã€‚ç»“è´¦æ—¶ï¼ŒæœåŠ¡å™¨è¯»å–å‘é€æ¥çš„Cookieå°±è¡Œäº†ã€‚

ä½†æ˜¯ä½¿ç”¨Cookieæœ‰å‡ ä¸ªç¼ºé™·ï¼š

1. Cookieä¼šè¢«é™„åŠ åˆ°æ¯ä¸ªHTTPè¯·æ±‚ä¸­ï¼Œæ— å½¢ä¸­å¢åŠ äº†æµé‡ã€‚
2. ç”±äºHTTPè¯·æ±‚ä¸­çš„Cookieæ˜¯æ˜æ–‡ä¼ é€’çš„ï¼Œæ‰€æœ‰å­˜åœ¨å®‰å…¨æ€§é—®é¢˜ï¼Œä¸€äº›æœ‰å®‰å…¨æ„è¯†çš„äººæˆ–å…¬å¸ä¼šæ‰‹åŠ¨å…³é—­Cookieè®¾ç½®ã€‚
3. Cookieå¤§å°é™åˆ¶åœ¨4KBå·¦å³ï¼Œæ— æ³•åº”å¯¹æ¯”è¾ƒå¤æ‚çš„å­˜å‚¨éœ€æ±‚ã€‚

ä¸ºäº†è§£å†³æœ¬åœ°å­˜å‚¨é—®é¢˜ï¼Œä½¿ç”¨Cookieæ˜¯ç›¸å¯¹è¿‡æ—¶çš„æ–¹æ¡ˆï¼Œå¦‚ä»Šæˆ‘ä»¬å¯ä»¥é€šè¿‡localStorageæ¥å®ç°ã€‚

## ä¸‰ã€åœ¨æ”¯æŒ HTML5 çš„æµè§ˆå™¨ä¸­å¼€å§‹localStorage

åœ¨ç°ä»£æµè§ˆå™¨ä¸­ä½¿ç”¨æœ¬åœ°localStorageæ˜¯ç›¸å½“å®¹æ˜“çš„ï¼Œä½ åªéœ€è¦åœ¨JavaScriptè„šæœ¬ä¸­ä¿®æ”¹localStorageå¯¹è±¡ï¼Œå®ƒæ˜¯key/valueå½¢å¼ï¼Œä¸ä¼ ç»Ÿçš„å¯¹è±¡ç±»ä¼¼ã€‚å¯ä»¥é€šè¿‡`setItem()`å’Œ`getItem()`æ–¹æ³•æ¥è®¿é—®å­˜å‚¨å’Œè¯»å–çš„åŠŸèƒ½ã€‚

	localStorage.setItem('girlfriend', 'huasen');
	var hername = localStorage('girlfriend');  
	// -> "huasen"

è¦åˆ é™¤è¿™ä¸ªkeyé¡¹ï¼Œä½ å¯ä»¥ä½¿ç”¨-ä½ èƒ½çŒœåˆ°ï¼Ÿâ€”â€”the `removeItem()`

	localStorage.removeItem('girlfriend);
	var hername = localStorage.getItem('girlfriend);
	// -> null

å¾ˆç®€å•æœ‰æœ¨æœ‰ï¼Ÿï¼å¦‚æœä½ å¸Œæœ›å…³é—­æµè§ˆå™¨å°±è‡ªåŠ¨æ¸…é™¤æ•°æ®ï¼Œé‚£ä½ å¯ä»¥ä½¿ç”¨sessionStorageæ¥ä»£æ›¿localStorageï¼Œå®ƒä»¬ç”¨æ³•ç›¸åŒï¼Œåªæ˜¯ç”Ÿå‘½å‘¨æœŸä¸åŒã€‚ï¼ˆlocalStorageé™¤éè¢«æ¸…é™¤ï¼Œå¦åˆ™ä¼šæ°¸ä¹…ä¿å­˜ï¼‰

## å››ã€ ä»…â€œå­—ç¬¦ä¸²â€é—®é¢˜

localStorageä¸­æœ‰ä¸€ä¸ªä»¤äººè®¨åŒğŸ˜’çš„ç¼ºç‚¹æ˜¯åªèƒ½åœ¨ä¸åŒçš„é”®keyä¸­å­˜å‚¨å­—ç¬¦ä¸²ï¼Œè¿™æ„å‘³ç€å½“ä½ å¼€å¼€å¿ƒå¿ƒnewå‡ºæ¥ä¸€ä¸ªå¯¹è±¡ï¼Œï¼ˆç»ˆäºæœ‰å¯¹è±¡äº†ã€‚ï¼‰å´ä¸èƒ½æŠŠå®ƒå­˜å‚¨èµ·æ¥ï¼Œ(ã¥â•¥ï¹â•¥)ã¥ã€‚

	var girl = {};
	girl.name = 'huasen';
	girl.hobby = ['singing', 'photography'];
	girl.sound = 'pleasant';
	console.log(girl);
	localStorage.setItem('girl', girl);
	console.log(localStorage.getItem('girl'));

åœ¨æ§åˆ¶å°ä¸­è¾“å‡ºï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªæ•°æ®æ˜¯ä»¥[object Object]çš„å½¢å¼å­˜å‚¨çš„ï¼Œè€Œä¸æ˜¯çœŸå®çš„å¯¹è±¡ä¿¡æ¯ã€‚
	
ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨åŸç”Ÿ`JSON.stringfy()`å’Œ`JSON.parse()`æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜

	localStorage.setItem('girl', JSON.stringify(girl));
	console.log(JSON.parse(localStorage.getItem('girl')));

è¯‘è‡ªï¼š[Local Storage And How To Use It On Websites](https://www.smashingmagazine.com/2010/10/local-storage-and-how-to-use-it/#where-to-find-local-storage-data-and-how-to-remove-it)

## è¿›ä¸€æ­¥é˜…è¯»

- [What is the difference between localStorage, sessionStorage, session and cookies?](https://stackoverflow.com/questions/19867599/what-is-the-difference-between-localstorage-sessionstorage-session-and-cookies)
- [MDN Using the Web Storage API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API)
- [ç»´åŸºç™¾ç§‘Cookie](https://zh.wikipedia.org/wiki/Cookie#Cookiesçš„æ›¿ä»£å“)
- [è¯¦è¯´ Cookie, LocalStorage ä¸ SessionStorage](http://jerryzou.com/posts/cookie-and-web-storage/)
